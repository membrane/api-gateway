# yaml-language-server: $schema=https://www.membrane-api.io/v7.1.0.json
api:
  port: 2000
  flow:
    - request:
        # Attention: The last matching `if` will win!
        - if:
            test: //order
            language: xpath
            flow:
              - destination:
                  url: internal://order
        - if:
            test: //order[@express='yes']
            language: xpath
            flow:
              - destination:
                  url: internal://express
        - if:
            test: //order/items/item[@id='7']
            language: xpath
            flow:
              - destination:
                  url: internal://import-items

---
api:
  # The name is needed to reference the API as internal://import-items
  name: import-items
  port: 3000
  flow:
    - static:
        src: Order contains import items.
    - return:
        status: 200

---
internal:
  name: order
  flow:
    - static:
        src: Normal order received.
    - return:
        status: 200

---
internal:
  name: express
  flow:
    - static:
        src: Express order received.
    - return: {}
