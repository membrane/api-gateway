<spring:beans xmlns="http://membrane-soa.org/proxies/1/"
              xmlns:spring="http://www.springframework.org/schema/beans"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
              http://membrane-soa.org/proxies/1/ http://membrane-soa.org/schemas/proxies-1.xsd">

    <!-- Health checks every 1s. -->
    <balancerHealthMonitor interval="1000">
        <httpClientConfig>
            <!-- Timeouts for the health probe HTTP call. -->
            <connection timeout="2000" soTimeout="2000"/>
        </httpClientConfig>
    </balancerHealthMonitor>

    <router production="false">

        <!-- Public LB endpoint (HTTPS) -->
        <api port="8000">
            <balancer name="Demo Balancer">
                <clusters>
                    <cluster name="Production">
                        <node host="localhost" port="8001" healthUrl="http://localhost:8001/health"/>
                        <node host="localhost" port="8002" healthUrl="http://localhost:8002/health"/>
                    </cluster>
                </clusters>
            </balancer>
            <target host="abc" port="123" />
        </api>

        <!-- Backend Node 1 -->
        <api port="8001" name="Node 1">
            <static>
                Hello from backend 1!
            </static>
            <request>
                <groovy>
                    <!-- Set to 3000 to simulate a socket read timeout -->
                    Thread.sleep(1000)
                </groovy>
            </request>
            <return/>
        </api>

        <!-- Backend Node 2 -->
        <api port="8002" name="Node 2">
            <static>
                Hello from backend 2!
            </static>
            <return/>
        </api>

        <api name="Console" port="9000">
            <adminConsole/>
        </api>

    </router>

</spring:beans>